"use strict";(self.webpackChunktyping=self.webpackChunktyping||[]).push([["84"],{624:function(e,t,a){a.r(t),a.d(t,{default:()=>d});var r=a("881"),s=a("987"),i=a("946"),n=a("556");let o=a("384").Z.create({baseURL:`https://${window.location.hostname}:${window.location.port}`,timeout:5e3,headers:{"Content-Type":"application/json"}});o.interceptors.request.use(e=>{let t=localStorage.getItem("token");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(Error(e.toString()))),o.interceptors.response.use(e=>e.data,e=>(console.error("HTTP Error:",e),Promise.reject(Error(e.toString()))));var l=a("94"),u=a("151");let p={style:{margin:"8px"}},d={__name:"login",setup(e){let t=(0,l.oR)(),a=(0,n.tv)(),{t:d,locale:m}=(0,i.QT)(),c=(0,r.qj)({userName:"",password:"",newPassword:""}),g=(0,r.iH)(!1),w=(0,r.iH)(!1),v=(0,r.iH)(""),h=(0,r.iH)({userName:[{required:!0,message:d("inputUserName")},{regex:/^[A-Z]{2,5}$/,message:d("inputUserNameTip")}],password:[{required:!0,message:d("inputPassword")},{regex:/^.{6,30}$/,message:d("inputPasswordTip")}],newPassword:[{required:!0,message:d("inputPassword")},{regex:/^.{6,30}$/,message:d("inputPasswordTip")}]}),b=(0,r.iH)(null),k=e=>{var t;null===(t=b.value)||void 0===t||t.validate(e)};(0,r.iH)("");let f=()=>{console.log("event cancel")},U=()=>{console.log("event ok")},_=(0,r.iH)(!1),y=()=>{var e;null===(e=b.value)||void 0===e||e.validate().then(async e=>{let{valid:r,errors:s}=e;if(r){_.value=!0;let e=o.post(u.y$.loginOrRegister,{userName:c.userName,password:c.password,newPassword:c.newPassword}),r=await e;if(_.value=!1,!r.data){w.value=!0,"needToResetPassword"===r.error?(g.value=!0,v.value=d("setNewPassword")):"excessRegisterCount"===r.error?v.value=d("excessRegisterCount"):v.value=d("userNameOrPasswordError");return}await t.dispatch("updateUser",r.data),await a.push("/loading")}})};return(e,t)=>{let a=(0,r.up)("router-link"),i=(0,r.up)("nut-navbar"),n=(0,r.up)("nut-input"),o=(0,r.up)("nut-form-item"),l=(0,r.up)("nut-form"),u=(0,r.up)("nut-button"),m=(0,r.up)("nut-dialog");return(0,r.wg)(),(0,r.iD)(r.HY,null,[(0,r.Wm)(i,{title:(0,r.SU)(d)("login")},{right:(0,r.w5)(()=>[(0,r.Wm)(a,{to:"/settings"},{default:(0,r.w5)(()=>[(0,r.Wm)((0,r.SU)(s.pE),{width:"16px"})]),_:1})]),_:1},8,["title"]),(0,r._)("div",p,[(0,r.Wm)(l,{ref_key:"formRef",ref:b,"model-value":c,rules:h.value},{default:(0,r.w5)(()=>[(0,r.Wm)(o,{label:(0,r.SU)(d)("userName"),prop:"userName"},{default:(0,r.w5)(()=>[(0,r.Wm)(n,{modelValue:c.userName,"onUpdate:modelValue":t[0]||(t[0]=e=>c.userName=e),clearable:"",onBlur:t[1]||(t[1]=e=>k("userName")),type:"text"},null,8,["modelValue"])]),_:1},8,["label"]),(0,r.Wm)(o,{label:(0,r.SU)(d)("password"),prop:"password"},{default:(0,r.w5)(()=>[(0,r.Wm)(n,{modelValue:c.password,"onUpdate:modelValue":t[2]||(t[2]=e=>c.password=e),clearable:"",type:"password"},null,8,["modelValue"])]),_:1},8,["label"]),g.value?((0,r.wg)(),(0,r.j4)(o,{key:0,label:(0,r.SU)(d)("newPassword"),prop:"newPassword"},{default:(0,r.w5)(()=>[(0,r.Wm)(n,{modelValue:c.newPassword,"onUpdate:modelValue":t[3]||(t[3]=e=>c.newPassword=e),clearable:"",type:"password"},null,8,["modelValue"])]),_:1},8,["label"])):(0,r.kq)("",!0)]),_:1},8,["model-value","rules"]),(0,r.Wm)(u,{type:"primary",block:"",loading:_.value,onClick:y},{default:(0,r.w5)(()=>[(0,r.Uk)((0,r.zw)((0,r.SU)(d)("login")),1)]),_:1},8,["loading"])]),(0,r.Wm)(m,{visible:w.value,"onUpdate:visible":t[4]||(t[4]=e=>w.value=e),title:(0,r.SU)(d)("tips"),content:v.value,okText:(0,r.SU)(d)("confirm"),"no-cancel-btn":!0,cancelText:(0,r.SU)(d)("cancel"),onOk:U,onCancel:f},null,8,["visible","title","content","okText","cancelText"])],64)}}}},151:function(e,t,a){a.d(t,{D$:function(){return n},_q:function(){return u},bY:function(){return l},ot:function(){return o},y$:function(){return i}});var r,s=a(438);let i={kick:"/api/kick",refreshGame:"/api/refreshGame",heart:"/api/heart",loginOrRegister:"/api/loginOrRegister",entryGame:"/api/entryGame",gameUserHistory:"/api/gameUserHistory",gameUserScore:"/api/gameUserScore",gameUserScoreHistory:"/api/gameUserScoreHistory",gameUserScoreMinus:"/api/gameUserScoreMinus",typeGameSettings:"/api/typeGameSettings",typeVerseContent:"/api/typeVerseContent",blankItRightSettings:"/api/blankItRightSettings",blankItRightContent:"/api/blankItRightContent",blankItRightBlank:"/api/blankItRightBlank",blankItRightSubmit:"/api/blankItRightSubmit",submit:"/api/submit"};class n{static toGameType(e){switch(e){case n.TYPE.code:return n.TYPE;case n.BLANK_IT_RIGHT.code:return n.BLANK_IT_RIGHT;case n.INPUT.code:return n.INPUT;default:return n.NONE}}constructor(e,t){(0,s._)(this,"code",void 0),(0,s._)(this,"path",void 0),this.code=e,this.path=t}}(0,s._)(n,"NONE",new n(0,"")),(0,s._)(n,"TYPE",new n(1,"/game/type-game")),(0,s._)(n,"BLANK_IT_RIGHT",new n(2,"/game/blank-it-right-game")),(0,s._)(n,"INPUT",new n(3,"/game/input-game"));class o{static from(e){let t=new o;return t.list=e.list,t.tips=e.tips,t}constructor(){(0,s._)(this,"list",void 0),(0,s._)(this,"tips",void 0),this.list=[],this.tips=[]}}class l{static from(e){let t=new l;return t.gameId=e.gameId||0,t.prevId=e.prevId||0,t.input=e.input||"",t}constructor(){(0,s._)(this,"gameId",void 0),(0,s._)(this,"prevId",void 0),(0,s._)(this,"input",void 0),this.gameId=0,this.prevId=0,this.input=""}}var u=((r={})[r.word=0]="word",r[r.single=1]="single",r[r.all=2]="all",r)}}]);