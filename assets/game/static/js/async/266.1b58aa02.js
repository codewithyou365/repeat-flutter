"use strict";(self.webpackChunktyping=self.webpackChunktyping||[]).push([["266"],{769:function(e,a,t){t.r(a),t.d(a,{default:()=>p});var r=t("464"),s=t("987"),i=t("118"),o=t("759");let l=t("384").Z.create({baseURL:`https://${window.location.hostname}:${window.location.port}`,timeout:5e3,headers:{"Content-Type":"application/json"}});l.interceptors.request.use(e=>{let a=localStorage.getItem("token");return a&&(e.headers.Authorization=`Bearer ${a}`),e},e=>Promise.reject(Error(e.toString()))),l.interceptors.response.use(e=>e.data,e=>(console.error("HTTP Error:",e),Promise.reject(Error(e.toString()))));var n=t("480"),u=t("151");let d={style:{margin:"8px"}},p={__name:"login",setup(e){let a=(0,n.oR)(),t=(0,o.tv)(),{t:p,locale:m}=(0,i.QT)(),c=(0,r.qj)({userName:"",password:"",newPassword:"",gamePassword:""}),w=(0,r.iH)(!1),g=(0,r.iH)(!1),S=(0,r.iH)(!1),v=(0,r.iH)(""),h=(0,r.iH)({userName:[{required:!0,message:p("inputUserName")},{regex:/^[A-Z]{2,5}$/,message:p("inputUserNameTip")}],password:[{required:!0,message:p("inputPassword")},{regex:/^.{6,30}$/,message:p("inputPasswordTip")}],newPassword:[{required:!0,message:p("inputPassword")},{regex:/^.{6,30}$/,message:p("inputPasswordTip")}],gamePassword:[{required:!0,message:p("inputPassword")},{regex:/^.{6,9}$/,message:p("inputPasswordTip")}]}),b=(0,r.iH)(null),_=e=>{var a;null===(a=b.value)||void 0===a||a.validate(e)};(0,r.iH)("");let k=()=>{console.log("event cancel")},P=()=>{console.log("event ok")},U=(0,r.iH)(!1),f=()=>{var e;null===(e=b.value)||void 0===e||e.validate().then(async e=>{let{valid:r,errors:s}=e;if(r){U.value=!0;let e=l.post(u.y$.loginOrRegister,{userName:c.userName,password:c.password,newPassword:c.newPassword,gamePassword:c.gamePassword}),r=await e;if(U.value=!1,!r.data){S.value=!0,w.value=!1,g.value=!1,v.value=p(r.error),"needToResetPassword"===r.error?w.value=!0:"gamePasswordError"===r.error&&(g.value=!0);return}await a.dispatch("updateUser",r.data),await t.push("/loading")}})};return(e,a)=>{let t=(0,r.up)("router-link"),i=(0,r.up)("nut-navbar"),o=(0,r.up)("nut-input"),l=(0,r.up)("nut-form-item"),n=(0,r.up)("nut-form"),u=(0,r.up)("nut-button"),m=(0,r.up)("nut-dialog");return(0,r.wg)(),(0,r.iD)(r.HY,null,[(0,r.Wm)(i,{title:(0,r.SU)(p)("login")},{right:(0,r.w5)(()=>[(0,r.Wm)(t,{to:"/settings"},{default:(0,r.w5)(()=>[(0,r.Wm)((0,r.SU)(s.pE),{width:"16px"})]),_:1})]),_:1},8,["title"]),(0,r._)("div",d,[(0,r.Wm)(n,{ref_key:"formRef",ref:b,"model-value":c,rules:h.value},{default:(0,r.w5)(()=>[(0,r.Wm)(l,{label:(0,r.SU)(p)("userName"),prop:"userName"},{default:(0,r.w5)(()=>[(0,r.Wm)(o,{modelValue:c.userName,"onUpdate:modelValue":a[0]||(a[0]=e=>c.userName=e),clearable:"",onBlur:a[1]||(a[1]=e=>_("userName")),type:"text"},null,8,["modelValue"])]),_:1},8,["label"]),(0,r.Wm)(l,{label:(0,r.SU)(p)("password"),prop:"password"},{default:(0,r.w5)(()=>[(0,r.Wm)(o,{modelValue:c.password,"onUpdate:modelValue":a[2]||(a[2]=e=>c.password=e),clearable:"",type:"password"},null,8,["modelValue"])]),_:1},8,["label"]),w.value?((0,r.wg)(),(0,r.j4)(l,{key:0,label:(0,r.SU)(p)("newPassword"),prop:"newPassword"},{default:(0,r.w5)(()=>[(0,r.Wm)(o,{modelValue:c.newPassword,"onUpdate:modelValue":a[3]||(a[3]=e=>c.newPassword=e),clearable:"",type:"password"},null,8,["modelValue"])]),_:1},8,["label"])):(0,r.kq)("",!0),g.value?((0,r.wg)(),(0,r.j4)(l,{key:1,label:(0,r.SU)(p)("gamePassword"),prop:"gamePassword"},{default:(0,r.w5)(()=>[(0,r.Wm)(o,{modelValue:c.gamePassword,"onUpdate:modelValue":a[4]||(a[4]=e=>c.gamePassword=e),clearable:"",type:"password"},null,8,["modelValue"])]),_:1},8,["label"])):(0,r.kq)("",!0)]),_:1},8,["model-value","rules"]),(0,r.Wm)(u,{type:"primary",block:"",loading:U.value,onClick:f},{default:(0,r.w5)(()=>[(0,r.Uk)((0,r.zw)((0,r.SU)(p)("login")),1)]),_:1},8,["loading"])]),(0,r.Wm)(m,{visible:S.value,"onUpdate:visible":a[5]||(a[5]=e=>S.value=e),title:(0,r.SU)(p)("tips"),content:v.value,okText:(0,r.SU)(p)("confirm"),"no-cancel-btn":!0,cancelText:(0,r.SU)(p)("cancel"),onOk:P,onCancel:k},null,8,["visible","title","content","okText","cancelText"])],64)}}}},151:function(e,a,t){t.d(a,{D$:function(){return o},_q:function(){return u},bY:function(){return n},ot:function(){return l},y$:function(){return i}});var r,s=t(438);let i={kick:"/api/kick",refreshGame:"/api/refreshGame",heart:"/api/heart",loginOrRegister:"/api/loginOrRegister",entryGame:"/api/entryGame",gameUserHistory:"/api/gameUserHistory",gameUserScore:"/api/gameUserScore",gameUserScoreHistory:"/api/gameUserScoreHistory",gameUserScoreMinus:"/api/gameUserScoreMinus",typeGameSettings:"/api/typeGameSettings",typeVerseContent:"/api/typeVerseContent",blankItRightSettings:"/api/blankItRightSettings",blankItRightContent:"/api/blankItRightContent",blankItRightBlank:"/api/blankItRightBlank",blankItRightSubmit:"/api/blankItRightSubmit",wordSlicerStatus:"/api/wordSlicerStatus",wordSlicerStatusUpdate:"/api/wordSlicerStatusUpdate",wordSlicerSelectRole:"/api/wordSlicerSelectRole",wordSlicerChooseColor:"/api/wordSlicerChooseColor",wordSlicerStartGame:"/api/wordSlicerStartGame",wordSlicerSubmit:"/api/wordSlicerSubmit",wordSlicerEdit:"/api/wordSlicerEdit",submit:"/api/submit"};class o{static toGameType(e){switch(e){case o.TYPE.code:return o.TYPE;case o.BLANK_IT_RIGHT.code:return o.BLANK_IT_RIGHT;case o.WORD_SLICER.code:return o.WORD_SLICER;case o.INPUT.code:return o.INPUT;default:return o.NONE}}constructor(e,a){(0,s._)(this,"code",void 0),(0,s._)(this,"path",void 0),this.code=e,this.path=a}}(0,s._)(o,"NONE",new o(0,"")),(0,s._)(o,"TYPE",new o(1,"/game/type-game")),(0,s._)(o,"BLANK_IT_RIGHT",new o(2,"/game/blank-it-right-game")),(0,s._)(o,"WORD_SLICER",new o(3,"/game/word-slicer-game")),(0,s._)(o,"INPUT",new o(4,"/game/input-game"));class l{static from(e){let a=new l;return a.list=e.list,a.tips=e.tips,a}constructor(){(0,s._)(this,"list",void 0),(0,s._)(this,"tips",void 0),this.list=[],this.tips=[]}}class n{static from(e){let a=new n;return a.gameId=e.gameId||0,a.prevId=e.prevId||0,a.input=e.input||"",a}constructor(){(0,s._)(this,"gameId",void 0),(0,s._)(this,"prevId",void 0),(0,s._)(this,"input",void 0),this.gameId=0,this.prevId=0,this.input=""}}var u=((r={})[r.word=0]="word",r[r.single=1]="single",r[r.all=2]="all",r)}}]);